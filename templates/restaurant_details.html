{% extends 'base.html' %}

{% block title %}{{ restaurant.name }} - Details{% endblock %}

{% block body %}
  <div class="d-flex flex-row align-items-center">
    <div class="col-6">
      <h1>{{ restaurant.name }}</h1>
    </div>
    <div class="col-6 d-flex justify-content-end">
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#favorites-modal">
        Favorite
      </button>
    </div>
  </div>

  <div class="modal fade" id="favorites-modal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Save to a Favorites List</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          {% if user.favorites_lists %}
            <p>Choose one of your Favorites lists to save to:</p>
            <form>
              <select id="favorite-list" class="form-select mb-4">
                <option selected>Choose a list...</option>
                {% for list in user.favorites_lists %}
                  <option value="{{ list.list_id }}">{{ list.name }}</option>
                {% endfor %}
              </select>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="save" value="{{ restaurant.restaurant_id }}">
                  Save
                </button>
              </div>
            </form>
          {% else %}
            <p>You do not have any Favorites lists yet.</p>
            <a href="/users/{{ user.user_id }}">
              Go to your profile to create one.
            </a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  
  <div class="row">
    <p>
      Rating: {{ restaurant.rating }}
    </p>
    <div class="col-4">
      <div class="card">
        <div class="card-header">Address</div>
        <div class="card-body">
          <p class="mb-0">
            {{ restaurant.street_address }}
          </p>
          <p>
            {{ restaurant.city }}, {{ restaurant.state }} {{ restaurant.zipcode }}
          </p>
        
          {% if restaurant.phone_number %}
            <p>
              Phone Number: {{ restaurant.phone_number }}
            </p>
          {% endif %}
        </div>
      </div>
    </div>
    
    {% if restaurant.business_hours %}
      <h3>Business Hours</h3>
  
      <ul>
          {% for day in restaurant.business_hours %}
            <li>  
            <p>{{ day }}</p>
            {% if restaurant.business_hours[day] %} 
              {% for hours in restaurant.business_hours[day] %}
                <p>{{ hours }}</p>
              {% endfor %}
            {% else %}
              <p>Closed</p>
            {% endif %}
            </li>
          {% endfor %}   
      </ul>
    {% endif %}
  </div>
  
  <div class="row">
    <h2>{{ restaurant.name }} - Images</h2>
  </div>
  
  <div class="d-flex flex-row">
    {% for image in images %}
      <div class="col">
        <img class="img-responsive img-thumbnail" src="{{ image.img_url }}">
      </div> 
    {% endfor %}
  </div>

  <div class="row">
    <h2>{{ restaurant.name }} - Reviews</h2>
  </div>
  
  <div class="row">
    <ul>
      {% for yelp_review in yelp_reviews %}
        <li>
          <p>Rating: {{ yelp_review.rating }}</p>
          <p>
            {{ yelp_review.body }}
          </p>
          <a href="{{ yelp_review.review_url }}" target="_blank" rel="noopener noreferrer">
            See more
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% endblock %}

{% block after_body %}
  <script src="/static/js/favorite.js"></script>
{% endblock %}